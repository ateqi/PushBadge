# Android桌面角标调研

## 一、背景

   安卓应用的角标是由Launcher支持的，而原生的Android系统Launcher并没有提供角标支持，所以各大手机厂商只能自己定制Launcher来实现，然后提供接口给外部使用。

## 二、主流厂商对角标的支持

华为：需要申请/申明权限，详见[文档中心](https://developer.huawei.com/consumer/cn/doc/development/Corner-Guides/30802)

    系统版本：EMUI4.1 及以上
    桌面版本：6.3.29

小米：支持

vivo：中高端支持，老版本不支持（7.0、8.0设备）

oppo：需要申请，详见[【应用服务】教你如何给应用软件申请Push角标功能 - 应用 - 开发者社区](https://open.oppomobile.com/bbs/forum.php?mod=viewthread&tid=2448&extra=page%3D1&aid=11392)

    发送相关格式的申请邮件

三星：支持。

    S9+以上需和通知的方式结合才能显示角标。
    三星Galaxy S6：可直接设置。设置为0则角标消失显示数量上限不限。

## 三、适配注意点

华为：

    BadgeNotification add_num 否 integer 应用角标累加数字非应用角标实际显示数字 例如，某应用当前有N条未读消息，若add_num设置为3，则每发一次消息，应用角标显示的数字累加3，为N+3

小米：详见[文档中心](https://dev.mi.com/console/doc/detail?pId=939)

    默认逻辑：当应用向通知栏发送了一条通知 （除了进度条样式和常驻通知外），应用图标的右上角就会显示「1」。角标的数字代表应用的通知数，即应用发送了「x」条通知，角标就会显示为「x」。
    开发者对角标的设置：MIUI6-MIUI11桌面应用与MIUI12及以后桌面应用调用有所区别

详见[文档中心](https://dev.mi.com/console/doc/detail?pId=2321)

    业务逻辑：在应用开启”显示桌面图标角标“权限的前提下，当应用发通知在通知显示后，通知栏会通知桌面更新应用图标角标。
    角标数值的计算逻辑：统计应用在通知栏里显示的除媒体通知、进度条通知和常驻通知外的所有通知，累加其messageCount值。每条通知的messageCount值默认为1，开发者可以通过反射的方式设置messageCount值。最大显示9，开发者可以通过设置通知messageCount值来突破这一限制。
    注：用户在桌面点击应用图标启动应用时，会同时隐藏掉应用角标。直到应用发送了新通知，或者更新了通知的messageCount值后，才会重新显示出角标。

vivo：详见[vivo开放平台](https://dev.vivo.com.cn/documentCenter/doc/459)

    成功接入：“桌面图标角标”默认关闭，需要用户手动开启。开启路径：“设置”-“通知与状态栏”-“应用通知管理”-应用名称-“桌面图标角标”。
    未成功接入：无“桌面图标角标”选项。
    注：视OS版本差异，“桌面图标角标”名称可能为“应用图标标记”或“桌面角标”。

oppo：申请角标接入规则（应用必须适配OPPO手机，保证角标功能测试通过）

    系统应用；

    国内外各区域用户量排名Top5的三方即时通讯类应用，且只允许显示即时通信消息类通知（如QQ、微信、facebook、line）；
    OPPO公司内部费商业化及运营性质的办公类型即时通信应用（如Teamtalk）；
    国内外邮件类应用（各区域各属于用户量第一梯队的应用）。

